<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PIANETA 3D LAB</title>

  <style>
    body{
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      margin:0;
      background:#f6f7fb;
      color:#111
    }
    header{
      position:sticky;
      top:0;
      background:#fff;
      padding:12px 14px;
      border-bottom:1px solid #e6e7ee;
      z-index:10
    }
    .row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    h1{font-size:16px;margin:0}
    input,textarea,button,select{
      padding:10px;
      border:1px solid #d9dbe7;
      border-radius:10px;
      font-size:14px
    }
    textarea{resize:vertical}
    button{cursor:pointer;background:#fff}
    .wrap{padding:12px}

    .tabs{display:flex;gap:8px;margin-left:auto}
    .tab{
      padding:8px 12px;
      border:1px solid #d9dbe7;
      border-radius:999px;
      background:#fff;
      font-size:13px
    }
    .tab.active{border-color:#7b8cff}

    .panel{
      background:#fff;
      border:1px solid #e6e7ee;
      border-radius:12px;
      padding:12px
    }
    .label{font-size:12px;color:#555;margin-bottom:4px}

    .grid1{
      display:grid;
      grid-template-columns:1fr;
      gap:10px
    }

    .hide{display:none}

    table{
      width:100%;
      border-collapse:collapse;
      margin-top:10px
    }
    th,td{
      font-size:12px;
      padding:8px;
      border-top:1px solid #eee;
      text-align:left
    }
    thead th{color:#555}

    .muted{font-size:12px;color:#666}
    .ok{background:#f4fff7;border-color:#bfe5cb}
    .danger{background:#fff5f5;border-color:#ffbcbc}

    /* Magazzino */
    .row-red td{background:#fff0f0}
    .qty.green{color:#0b7a2a;font-weight:700}
    .qty.red{color:#b00020;font-weight:700}

    @media print{
      header,.tabs,.no-print{display:none}
      body{background:#fff}
    }
  </style>
</head>

<body>

<header>
  <div class="row">
    <h1>ü™ê PIANETA 3D LAB</h1>
    <div class="tabs">
      <button class="tab active" id="tab-new" onclick="showNew();setActive('new')">Nuovo ordine</button>
      <button class="tab" id="tab-prep" onclick="showPrep();setActive('prep')">Produzione</button>
      <button class="tab" id="tab-stock" onclick="showStock();setActive('stock')">Magazzino</button>
      <button class="tab" id="tab-reports" onclick="openReports();setActive('reports')">Report</button>
    </div>
  </div>
</header>

<div class="wrap">

  <!-- NUOVO ORDINE -->
  <div id="page-new" class="panel">
    <div class="grid1">
      <div>
        <div class="label">Cliente</div>
        <input id="cliente">
      </div>
      <div>
        <div class="label">Sito vendita</div>
        <input id="sito">
      </div>
      <div>
        <div class="label">Codice prodotto</div>
        <input id="progetto">
      </div>
      <div>
        <div class="label">Prezzo (‚Ç¨)</div>
        <input id="prezzo" type="number" step="0.01">
      </div>
      <div>
        <div class="label">Note</div>
        <textarea id="note"></textarea>
      </div>
    </div>

    <div class="row no-print" style="margin-top:10px">
      <button class="ok" onclick="addOrder()">INVIA ORDINE (INVIO)</button>
      <span class="muted">TAB / ‚Üë ‚Üì per muoverti</span>
    </div>

    <table>
      <thead>
        <tr>
          <th>Prodotto</th><th>Cliente</th><th>Sito</th>
          <th>‚Ç¨</th><th>Stato</th>
        </tr>
      </thead>
      <tbody id="activeTbody"></tbody>
    </table>
  </div>

  <!-- PRODUZIONE -->
  <div id="page-prep" class="hide">
    <div class="panel">
      <div id="board"></div>
    </div>
  </div>

  <!-- MAGAZZINO -->
  <div id="page-stock" class="hide">
    <div class="panel">
      <div class="grid1">
        <input id="stockCode" placeholder="Codice prodotto">
        <input id="stockQty" type="number" min="0" placeholder="Quantit√†">
        <button class="ok" onclick="addOrUpdateStock()">Salva</button>
      </div>

      <table>
        <thead>
          <tr><th>Codice</th><th>Quantit√†</th><th></th></tr>
        </thead>
        <tbody id="stockTbody"></tbody>
      </table>
    </div>
  </div>

  <!-- REPORT -->
  <div id="page-reports" class="hide">
    <div class="panel">
      <div class="row no-print">
        <select id="reportMode" onchange="syncReportFilters();refreshReports()">
          <option value="daily">Giornaliero</option>
          <option value="monthly">Mensile</option>
          <option value="pickday">Giorno specifico</option>
          <option value="pickmonth">Mese specifico</option>
        </select>
        <input type="date" id="reportDay" style="display:none">
        <input type="month" id="reportMonth" style="display:none">
        <button onclick="refreshReports()">Aggiorna</button>
        <button onclick="window.print()">Stampa</button>
      </div>

      <div id="reportsWrap"></div>
    </div>
  </div>

</div>

<!-- Parse SDK -->
<script src="https://unpkg.com/parse/dist/parse.min.js"></script>
<script src="app.js"></script>

<script>
  function setActive(k){
    ["new","prep","stock","reports"].forEach(x=>{
      document.getElementById("tab-"+x)?.classList.toggle("active",x===k)
    })
  }
  function syncReportFilters(){
    reportDay.style.display = reportMode.value==="pickday"?"inline":"none";
    reportMonth.style.display = reportMode.value==="pickmonth"?"inline":"none";
  }
</script>

</body>
</html>
